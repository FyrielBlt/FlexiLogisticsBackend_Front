{"ast":null,"code":"import BreadCrumb from \"../../components/Intermediaire/BreadCrumb.vue\";\nimport { ref } from 'vue';\nimport axios from \"axios\";\nimport PaginationVue from \"../../components/Intermediaire/pagination/PaginationVue.vue\";\nimport FilesModal from \"./FilesModal.vue\";\nexport default {\n  components: {\n    BreadCrumb,\n    PaginationVue,\n    FilesModal\n  },\n\n  data() {\n    return {\n      demandes: [],\n      open: ref(false),\n      success: false,\n      description: '',\n      depart: '',\n      arrive: '',\n      num: '',\n      villes: [],\n      updateinputdisable: true,\n      update: true,\n      descupdate: \"\",\n      departupdate: \"\",\n      arriveupdate: \"\",\n      poids: \"\",\n      largeur: \"\",\n      hauteur: \"\",\n      datedemande: \"\",\n      page: 1,\n      perpage: 5,\n      departfilter: '',\n      arrivefilter: '',\n      today: new Date().toISOString().split(\"T\")[0],\n      Files: [],\n      total: 0,\n      acheve: \"\"\n    };\n  },\n\n  created() {\n    axios.get(\"http://localhost:5000/api/EtatDemandeLivraisons/check?etat=Encours\").then(response => {\n      this.encdt = response.data.idEtatDemande;\n    });\n    axios.get(\"http://localhost:5000/api/EtatDemandeLivraisons/check?etat=acheve\").then(response => {\n      this.acheve = response.data.idEtatDemande;\n    }), axios.get(\"http://localhost:5000/api/demandelivraisons/client/\" + localStorage.getItem(\"iduser\")).then(response => {\n      this.demandes = response.data;\n      this.total = response.data.length;\n    });\n    axios.get('http://localhost:5000/api/villes').then(resp => this.villes = resp.data);\n  },\n\n  methods: {\n    FileSelected(event) {\n      this.Files = event.target.files;\n      console.log(this.Files);\n    },\n\n    ChangePage(NumPage) {\n      this.page = NumPage;\n      axios.get(\"http://localhost:5000/api/demandelivraisons/client/\" + localStorage.getItem(\"iduser\") + \"?page=\" + this.page + \"&quantityPage=\" + this.perpage + \"&depart=\" + this.departfilter + \"&arrive=\" + this.arrivefilter + \"&num=\" + this.num).then(resp => {\n        this.demandes = resp.data;\n      });\n    },\n\n    livrer(u) {\n      axios.put(\"http://localhost:5000/api/demandelivraisons/\" + u.idDemande, {\n        idDemande: u.idDemande,\n        description: u.description,\n        datecreation: u.datecreation,\n        adressdepart: u.adressdepart,\n        adressarrive: u.adressarrive,\n        date: u.date,\n        poids: u.poids,\n        largeur: u.largeur,\n        hauteur: u.hauteur,\n        idEtatdemande: this.acheve,\n        idclient: u.idclient\n      }).then(() => {\n        axios.get(\"http://localhost:5000/api/demandelivraisons/client/\" + localStorage.getItem(\"iduser\")).then(response => {\n          this.demandes = response.data;\n          Swal.fire('Updated!', 'Your offer has been updated.', 'success');\n        });\n      });\n    },\n\n    /* updatedemande(id, index) {\r\n       axios.put('http://localhost:5000/api/demandelivraisons/' + id, {\r\n         \"idDemande\": id,\r\n         \"description\": this.demandes[index].description,\r\n         \"datecreation\": this.demandes[index].datecreation,\r\n         \"adressdepart\": this.demandes[index].adressdepart,\r\n         \"poids\": this.demandes[index].poids,\r\n         \"largeur\": this.demandes[index].largeur,\r\n         \"hauteur\": this.demandes[index].hauteur,\r\n         \"date\": this.demandes[index].date,\r\n         \"adressarrive\": this.demandes[index].adressarrive,\r\n         \"idEtatdemande\": this.demandes[index].idEtatdemande,\r\n         \"idclient\": this.demandes[index].idclient,\r\n       }).then(() => {\r\n         this.updateinputdisable = !this.updateinputdisable\r\n       })\r\n     },*/\n    demandelivraisons() {\n      const date = new Date();\n\n      if (this.depart == this.arrive) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Oops...',\n          text: 'Adresse depart et arrivé doit etre different'\n        });\n      } else {\n        axios.post('http://localhost:5000/api/demandelivraisons', {\n          \"description\": this.description,\n          \"datecreation\": date.getFullYear() + '-' + date.getMonth() + '-' + date.getDate(),\n          \"adressdepart\": this.depart,\n          \"adressarrive\": this.arrive,\n          \"poids\": this.poids,\n          \"largeur\": this.largeur,\n          \"hauteur\": this.hauteur,\n          \"date\": this.datedemande,\n          \"idEtatdemande\": 2002,\n          \"idclient\": parseInt(localStorage.getItem(\"clientid\"))\n        }).then(r => {\n          if (this.Files.length > 0) {\n            for (let i = 0; i < this.Files.length; i++) {\n              let filedemande = new FormData();\n              filedemande.append(\"idDemande\", r.data.idDemande);\n              filedemande.append(\"File\", this.Files[i]);\n              axios.post(\"http://localhost:5000/api/filedemandelivraisons/\", filedemande);\n            }\n          }\n\n          axios.get(\"http://localhost:5000/api/demandelivraisons/client/\" + localStorage.getItem(\"iduser\")).then(response => {\n            this.demandes = response.data;\n            this.open = false;\n            this.$swal({\n              position: \"top-end\",\n              icon: \"success\",\n              toast: true,\n              title: \"Demande Ajouté Avec Succée\",\n              showConfirmButton: false,\n              timer: 2000\n            });\n            location.reload();\n          });\n        }).catch(error => console.log(error));\n      }\n    },\n\n    supprimer(id) {\n      Swal.fire({\n        title: 'Are you sure?',\n        text: \"You won't be able to revert this!\",\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#3085d6',\n        cancelButtonColor: '#d33',\n        confirmButtonText: 'Yes, delete it!'\n      }).then(result => {\n        if (result.isConfirmed) {\n          axios.delete('http://localhost:5000/api/demandelivraisons/' + id).then(() => {\n            axios.get(\"http://localhost:5000/api/demandelivraisons/client/\" + localStorage.getItem(\"iduser\")).then(response => {\n              this.demandes = response.data;\n            });\n          });\n          const Toast = Swal.mixin({\n            toast: true,\n            position: 'top-end',\n            showConfirmButton: false,\n            timer: 3000,\n            timerProgressBar: true,\n            didOpen: toast => {\n              toast.addEventListener('mouseenter', Swal.stopTimer);\n              toast.addEventListener('mouseleave', Swal.resumeTimer);\n            }\n          });\n          Toast.fire({\n            icon: 'success',\n            title: 'Demande supprimé avec succée'\n          });\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["BreadCrumb","ref","axios","PaginationVue","FilesModal","components","data","demandes","open","success","description","depart","arrive","num","villes","updateinputdisable","update","descupdate","departupdate","arriveupdate","poids","largeur","hauteur","datedemande","page","perpage","departfilter","arrivefilter","today","Date","toISOString","split","Files","total","acheve","created","get","then","response","encdt","idEtatDemande","localStorage","getItem","length","resp","methods","FileSelected","event","target","files","console","log","ChangePage","NumPage","livrer","u","put","idDemande","datecreation","adressdepart","adressarrive","date","idEtatdemande","idclient","Swal","fire","demandelivraisons","icon","title","text","post","getFullYear","getMonth","getDate","parseInt","r","i","filedemande","FormData","append","$swal","position","toast","showConfirmButton","timer","location","reload","catch","error","supprimer","id","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","result","isConfirmed","delete","Toast","mixin","timerProgressBar","didOpen","addEventListener","stopTimer","resumeTimer"],"sourceRoot":"","sources":["C:\\Users\\user\\Desktop\\pfe\\frontfinal\\src\\views\\Client\\demande.vue"],"sourcesContent":["<template>\r\n  <!-- Breadcrumb -->\r\n  <bread-crumb>\r\n    <template v-slot:bread1> Demandes </template>\r\n  </bread-crumb>\r\n  <!-- <Breadcrumb breadcrumb=\"Demandes\" /> -->\r\n  <button @click=\"open = true\"\r\n    class=\"px-6 py-2 mt-3 font-medium tracking-wide text-white bg-indigo-600 hover:bg-indigo-900 focus:outline-none animate__animated animate__shakeX animate__delay-1s\"\r\n    style=\"position: relative; left: 498px; top: -87px; height: 57px\">\r\n    Demande Livraison\r\n  </button>\r\n  <div :class=\"`modal ${!open && 'opacity-0 pointer-events-none'\r\n  } z-50 fixed w-full h-full top-0 left-0 flex items-center justify-center`\">\r\n    <div @click=\"open = false\" class=\"absolute w-full h-full bg-gray-900 opacity-50 modal-overlay\"></div>\r\n\r\n    <div class=\"z-50 w-11/12 mx-auto overflow-y-auto bg-white rounded shadow-lg modal-container\" style=\"width: 681px\">\r\n      <div\r\n        class=\"absolute top-0 right-0 z-50 flex flex-col items-center mt-4 mr-4 text-sm text-white cursor-pointer modal-close\">\r\n        <svg class=\"text-white fill-current\" xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\"\r\n          viewBox=\"0 0 18 18\">\r\n          <path\r\n            d=\"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z\" />\r\n        </svg>\r\n        <span class=\"text-sm\">(Esc)</span>\r\n      </div>\r\n\r\n      <!-- Add margin if you want to see some of the overlay behind the modal-->\r\n      <div class=\"px-6 py-4 text-left modal-content\">\r\n        <!--Title-->\r\n        <div class=\"flex items-center justify-between pb-3\">\r\n          <p class=\"text-2xl font-bold\">Demande Livraison</p>\r\n          <div class=\"z-50 cursor-pointer modal-close\" @click=\"open = false\">\r\n            <svg class=\"text-black fill-current\" xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\"\r\n              viewBox=\"0 0 18 18\">\r\n              <path\r\n                d=\"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z\" />\r\n            </svg>\r\n          </div>\r\n        </div>\r\n\r\n        <!--Body-->\r\n        <form @submit.prevent=\"demandelivraisons\">\r\n          <div class=\"px-5 py-6 text-gray-700 bg-gray-200 border-b grid grid-cols-2 gap-2\">\r\n            <div class=\"relative mt-2 rounded-md shadow-sm\">\r\n              <label class=\"text-xs\">Description</label>\r\n\r\n              <textarea required\r\n                class=\"w-full px-2 py-2 border-transparent rounded-md appearance-none focus:border-indigo-600 focus:ring focus:ring-opacity-40 focus:ring-indigo-500\"\r\n                v-model=\"description\" />\r\n            </div>\r\n            <div class=\"relative mt-2 rounded-md shadow-sm\">\r\n              <label class=\"text-xs\">Poids</label>\r\n\r\n              <input required\r\n                class=\"w-full px-2 py-2 border-transparent rounded-md appearance-none focus:border-indigo-600 focus:ring focus:ring-opacity-40 focus:ring-indigo-500\"\r\n                type=\"number\" v-model=\"poids\" />\r\n            </div>\r\n            <div class=\"relative mt-2 rounded-md shadow-sm\">\r\n              <label class=\"text-xs\">Adresse depart</label>\r\n\r\n              <select required name=\"\"\r\n                class=\"w-full px-2 py-2 border-transparent rounded-md appearance-none focus:border-indigo-600 focus:ring focus:ring-opacity-40 focus:ring-indigo-500\"\r\n                id=\"\" v-model=\"depart\">\r\n                <option v-for=\"ville in villes\" :key=\"ville\" :value=\"ville.nomVille\">\r\n                  {{ ville.nomVille }}\r\n                </option>\r\n              </select>\r\n            </div>\r\n\r\n            <div class=\"relative mt-2 rounded-md shadow-sm\">\r\n              <label class=\"text-xs\">Adresse arrive</label>\r\n\r\n              <select required name=\"\"\r\n                class=\"w-full px-2 py-2 border-transparent rounded-md appearance-none focus:border-indigo-600 focus:ring focus:ring-opacity-40 focus:ring-indigo-500\"\r\n                id=\"\" v-model=\"arrive\">\r\n                <option v-for=\"ville in villes\" :key=\"ville\" :value=\"ville.nomVille\">\r\n                  {{ ville.nomVille }}\r\n                </option>\r\n              </select>\r\n            </div>\r\n\r\n            <div class=\"relative mt-2 rounded-md shadow-sm\">\r\n              <label class=\"text-xs\">Largeur</label>\r\n\r\n              <input required\r\n                class=\"w-full px-2 py-2 border-transparent rounded-md appearance-none focus:border-indigo-600 focus:ring focus:ring-opacity-40 focus:ring-indigo-500\"\r\n                type=\"number\" v-model=\"largeur\" />\r\n            </div>\r\n\r\n            <div class=\"relative mt-2 rounded-md shadow-sm\">\r\n              <label class=\"text-xs\">Hauteur</label>\r\n\r\n              <input required\r\n                class=\"w-full px-2 py-2 border-transparent rounded-md appearance-none focus:border-indigo-600 focus:ring focus:ring-opacity-40 focus:ring-indigo-500\"\r\n                type=\"number\" v-model=\"hauteur\" />\r\n            </div>\r\n\r\n            <div class=\"relative mt-2 rounded-md shadow-sm\">\r\n              <label class=\"text-xs\">Date</label>\r\n\r\n              <input required\r\n                class=\"w-full px-2 py-2 border-transparent rounded-md appearance-none focus:border-indigo-600 focus:ring focus:ring-opacity-40 focus:ring-indigo-500\"\r\n                type=\"date\" :min=\"this.today\" v-model=\"datedemande\" />\r\n            </div>\r\n            <div class=\"relative mt-2 rounded-md shadow-sm\">\r\n              <label class=\"text-xs\">Fchiers</label>\r\n              <input type=\"file\" name=\"file\" id=\"file\" @change=\"FileSelected($event)\" multiple />\r\n            </div>\r\n          </div>\r\n          <div class=\"flex justify-end pt-2\">\r\n            <button @click=\"open = false\"\r\n              class=\"p-3 px-2 py-3 mr-2 text-indigo-500 bg-transparent rounded-lg hover:bg-gray-100 hover:text-indigo-400 focus:outline-none\">\r\n              Close\r\n            </button>\r\n            <button type=\"submit\"\r\n              class=\"px-2 py-3 font-medium tracking-wide text-white bg-indigo-600 rounded-md hover:bg-indigo-500 focus:outline-none\">\r\n              Valider\r\n            </button>\r\n          </div>\r\n        </form>\r\n\r\n        <!--Footer-->\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div style=\"margin-top: -70px\">\r\n    <div class=\"flex justify-center\">\r\n      <h4 class=\"font-semibold p-3\">Per Page :</h4>\r\n      <div class=\"mb-3 p-3\">\r\n        <select v-model=\"perpage\" @change=\"ChangePage(page)\"\r\n          class=\"form-select appearance-none block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding bg-no-repeat border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none\"\r\n          aria-label=\"Default select example\">\r\n          <option :value=\"2\">2</option>\r\n          <option :value=\"5\">5</option>\r\n          <option :value=\"10\">10</option>\r\n        </select>\r\n      </div>\r\n\r\n      <h4 class=\"font-semibold p-3\">Depart :</h4>\r\n      <div class=\"mb-3 xl:w-96 p-3\">\r\n        <select v-model=\"departfilter\" @change=\"ChangePage(page)\"\r\n          class=\"form-select appearance-none block w-full px-3 py-1.5 text-base font-semibold text-gray-700 bg-white bg-clip-padding bg-no-repeat border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none\"\r\n          aria-label=\"Default select example\">\r\n          <option value=\"\" class=\"font-semibold\" selected>--Vide--</option>\r\n          <option v-for=\"v in villes\" :key=\"v\" :value=\"v.nomVille\">\r\n            --{{ v.nomVille }}--\r\n          </option>\r\n        </select>\r\n      </div>\r\n      <h4 class=\"font-semibold p-3\">Arrive :</h4>\r\n      <div class=\"mb-3 xl:w-96 p-3\">\r\n        <select v-model=\"arrivefilter\" @change=\"ChangePage(page)\"\r\n          class=\"form-select appearance-none block w-full px-3 py-1.5 text-base font-semibold text-gray-700 bg-white bg-clip-padding bg-no-repeat border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none\"\r\n          aria-label=\"Default select example\">\r\n          <option value=\"\" class=\"font-semibold\" selected>--Vide--</option>\r\n          <option v-for=\"v in villes\" :key=\"v\" :value=\"v.nomVille\">\r\n            --{{ v.nomVille }}--\r\n          </option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"px-4 py-4 -mx-4 overflow-x-auto sm:-mx-8 sm:px-8\">\r\n      <div class=\"inline-block min-w-full overflow-hidden rounded-lg shadow\">\r\n        <input v-model=\"num\" @keyup=\"ChangePage(page)\"\r\n          class=\"appearance-none block text-gray-700 border border-red-500 rounded py-2 px-2 mb-2 leading-tight focus:outline-none focus:bg-white\"\r\n          id=\"grid-first-name\" type=\"text\" placeholder=\"Num demande\" />\r\n        <table class=\"divide-y divide-gray-300\" style=\"width: 100%\">\r\n          <thead class=\"bg-gray-100\">\r\n            <tr>\r\n              <th class=\"px-6 text-xs text-gray-500\">NUM</th>\r\n              <th class=\"px-6 py-2 text-xs text-gray-500\">DESCRIPTION</th>\r\n              <th class=\"px-6 py-2 text-xs text-gray-500\">ADRESSE DEPART</th>\r\n              <th class=\"px-6 py-2 text-xs text-gray-500\">ADRESSE ARRIVE</th>\r\n              <th class=\"px-6 py-2 text-xs text-gray-500\">\r\n                PONDS(KG)/DIMENSION(CM)\r\n              </th>\r\n              <th class=\"px-6 py-2 text-xs text-gray-500\">DATE</th>\r\n              <th class=\"px-6 py-2 text-xs text-gray-500\">FILE</th>\r\n              <th class=\"px-6 py-2 text-xs text-gray-500\">ETAT</th>\r\n              <th class=\"px-6 py-2 text-xs text-gray-500\">Paramétre</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody class=\"bg-white divide-y divide-gray-500\">\r\n            <tr class=\"whitespace-nowrap\" v-for=\"(u, index) in demandes\" :key=\"index\">\r\n              <td class=\"px-6 text-sm bg-white border-b border-gray-200\">\r\n                {{ u.idDemande }}\r\n              </td>\r\n              <td class=\"text-sm bg-white border-b border-gray-200\" style=\"padding: 30px 49px\">\r\n                <div class=\"flex items-center\">\r\n                  <div class=\"ml-3\">\r\n                    <p class=\"text-gray-900 whitespace-nowrap\">\r\n                      {{ u.description }}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </td>\r\n              <td class=\"text-sm bg-white border-b border-gray-200\">\r\n                <span>{{ u.adressdepart }}</span>\r\n              </td>\r\n              <td class=\"text-sm bg-white border-b border-gray-200\">\r\n                <span>{{ u.adressarrive }}</span>\r\n\r\n              </td>\r\n              <td class=\"text-sm bg-white border-b border-gray-200\">\r\n                P : {{ u.poids }}\r\n                L : {{ u.largeur }}\r\n                H : {{ u.hauteur }}\r\n\r\n              </td>\r\n              <td class=\"text-sm bg-white border-b border-gray-200\">\r\n                <span>{{ u.date.substr(0, 10) }}</span>\r\n              </td>\r\n              <td class=\"px-5 py-5 text-sm bg-white border-b border-gray-200\" style=\"padding: 30px 49px\">\r\n                <files-modal :u=\"u\"></files-modal>\r\n              </td>\r\n\r\n              <td class=\"px-5 py-5 text-sm bg-white border-b border-gray-200\">\r\n                {{ u.idEtatdemandeNavigation.etatDemande }}\r\n              </td>\r\n              <td class=\"px-5 py-5 text-sm bg-white border-b border-gray-200\">\r\n                <div class=\"flex justify-around\">\r\n                  <span class=\"text-yellow-500 flex justify-center\" v-if=\"u.offre.length == 0\">\r\n                    <button @click=\"supprimer(u.idDemande)\" class=\"mx-2 px-2 rounded-md\">\r\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5 text-red-700\" viewBox=\"0 0 20 20\"\r\n                        fill=\"currentColor\">\r\n                        <path fill-rule=\"evenodd\"\r\n                          d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\"\r\n                          clip-rule=\"evenodd\" />\r\n                      </svg>\r\n                    </button>\r\n                  </span>\r\n                  <div v-else>\r\n                    <button\r\n                      class=\"bg-white hover:bg-green-100 text-green-800 font-semibold py-2 px-4 border border-green-400 rounded shadow\"\r\n                      @click=\"livrer(u)\" v-if=\"u.idEtatdemande == encdt\">\r\n                      Achevé\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n        <div class=\"flex flex-col items-center px-2 py-2 bg-white border-t xs:flex-row xs:justify-between\">\r\n          <div class=\"inline-flex xs:mt-0\">\r\n            <!-- PAGINATION -->\r\n            <pagination-vue :current=\"page\" :total=\"total\" :per-page=\"perpage\" @page-changed=\"ChangePage\">\r\n            </pagination-vue>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script lang=\"js\">\r\nimport BreadCrumb from \"../../components/Intermediaire/BreadCrumb.vue\";\r\nimport { ref } from 'vue'\r\nimport axios from \"axios\";\r\nimport PaginationVue from \"../../components/Intermediaire/pagination/PaginationVue.vue\";\r\nimport FilesModal from \"./FilesModal.vue\";\r\n\r\nexport default {\r\n  components: {\r\n    BreadCrumb,\r\n    PaginationVue,\r\n    FilesModal\r\n  },\r\n  data() {\r\n    return {\r\n      demandes: [],\r\n      open: ref(false),\r\n      success: false,\r\n      description: '',\r\n      depart: '',\r\n      arrive: '',\r\n      num: '',\r\n      villes: [],\r\n      updateinputdisable: true,\r\n      update: true,\r\n      descupdate: \"\",\r\n      departupdate: \"\",\r\n      arriveupdate: \"\",\r\n      poids: \"\",\r\n      largeur: \"\",\r\n      hauteur: \"\",\r\n      datedemande: \"\",\r\n      page: 1,\r\n      perpage: 5,\r\n      departfilter: '',\r\n      arrivefilter: '',\r\n      today: new Date().toISOString().split(\"T\")[0],\r\n      Files: [],\r\n      total: 0,\r\n      acheve: \"\"\r\n    }\r\n  },\r\n\r\n  created() {\r\n    axios\r\n      .get(\r\n        \"http://localhost:5000/api/EtatDemandeLivraisons/check?etat=Encours\"\r\n      )\r\n      .then((response) => {\r\n        this.encdt = response.data.idEtatDemande;\r\n      })\r\n    axios\r\n      .get(\r\n        \"http://localhost:5000/api/EtatDemandeLivraisons/check?etat=acheve\"\r\n      )\r\n      .then((response) => {\r\n        this.acheve = response.data.idEtatDemande;\r\n      }),\r\n      axios\r\n        .get(\"http://localhost:5000/api/demandelivraisons/client/\" + localStorage.getItem(\"iduser\"))\r\n        .then((response) => {\r\n          this.demandes = response.data\r\n          this.total = response.data.length\r\n        })\r\n\r\n    axios.get('http://localhost:5000/api/villes').then((resp) => this.villes = resp.data)\r\n\r\n\r\n  },\r\n  methods: {\r\n    FileSelected(event) {\r\n      this.Files = event.target.files;\r\n      console.log(this.Files);\r\n    },\r\n    ChangePage(NumPage) {\r\n      this.page = NumPage;\r\n\r\n      axios\r\n        .get(\r\n          \"http://localhost:5000/api/demandelivraisons/client/\" +\r\n          localStorage.getItem(\"iduser\") +\r\n          \"?page=\" +\r\n          this.page +\r\n          \"&quantityPage=\" +\r\n          this.perpage +\r\n          \"&depart=\" +\r\n          this.departfilter +\r\n          \"&arrive=\" +\r\n          this.arrivefilter +\r\n          \"&num=\" +\r\n          this.num\r\n        )\r\n        .then((resp) => {\r\n          this.demandes = resp.data;\r\n        });\r\n\r\n    },\r\n    livrer(u) {\r\n      axios.put(\r\n        \"http://localhost:5000/api/demandelivraisons/\" + u.idDemande,\r\n        {\r\n          idDemande: u.idDemande,\r\n          description: u.description,\r\n          datecreation: u.datecreation,\r\n          adressdepart: u.adressdepart,\r\n          adressarrive: u.adressarrive,\r\n          date: u.date,\r\n          poids: u.poids,\r\n          largeur: u.largeur,\r\n          hauteur: u.hauteur,\r\n          idEtatdemande: this.acheve,\r\n          idclient: u.idclient,\r\n        }\r\n      ).then(() => {\r\n        axios\r\n          .get(\"http://localhost:5000/api/demandelivraisons/client/\" + localStorage.getItem(\"iduser\"))\r\n          .then((response) => {\r\n            this.demandes = response.data\r\n            Swal.fire(\r\n              'Updated!',\r\n              'Your offer has been updated.',\r\n              'success'\r\n            )\r\n          })\r\n\r\n      });\r\n    },\r\n    /* updatedemande(id, index) {\r\n       axios.put('http://localhost:5000/api/demandelivraisons/' + id, {\r\n         \"idDemande\": id,\r\n         \"description\": this.demandes[index].description,\r\n         \"datecreation\": this.demandes[index].datecreation,\r\n         \"adressdepart\": this.demandes[index].adressdepart,\r\n         \"poids\": this.demandes[index].poids,\r\n         \"largeur\": this.demandes[index].largeur,\r\n         \"hauteur\": this.demandes[index].hauteur,\r\n         \"date\": this.demandes[index].date,\r\n         \"adressarrive\": this.demandes[index].adressarrive,\r\n         \"idEtatdemande\": this.demandes[index].idEtatdemande,\r\n         \"idclient\": this.demandes[index].idclient,\r\n       }).then(() => {\r\n         this.updateinputdisable = !this.updateinputdisable\r\n       })\r\n     },*/\r\n    demandelivraisons() {\r\n      const date = new Date();\r\n      if (this.depart == this.arrive) {\r\n        Swal.fire({\r\n          icon: 'error',\r\n          title: 'Oops...',\r\n          text: 'Adresse depart et arrivé doit etre different',\r\n        })\r\n      } else {\r\n        axios.post('http://localhost:5000/api/demandelivraisons', {\r\n          \"description\": this.description,\r\n          \"datecreation\": date.getFullYear() + '-' + date.getMonth() + '-' + date.getDate(),\r\n          \"adressdepart\": this.depart,\r\n          \"adressarrive\": this.arrive,\r\n          \"poids\": this.poids,\r\n          \"largeur\": this.largeur,\r\n          \"hauteur\": this.hauteur,\r\n          \"date\": this.datedemande,\r\n          \"idEtatdemande\": 2002,\r\n          \"idclient\": parseInt(localStorage.getItem(\"clientid\"))\r\n        }).then((r) => {\r\n          if (this.Files.length > 0) {\r\n            for (let i = 0; i < this.Files.length; i++) {\r\n              let filedemande = new FormData();\r\n              filedemande.append(\"idDemande\", r.data.idDemande);\r\n              filedemande.append(\"File\", this.Files[i]);\r\n              axios.post(\"http://localhost:5000/api/filedemandelivraisons/\", filedemande)\r\n            }\r\n\r\n          }\r\n\r\n          axios\r\n            .get(\"http://localhost:5000/api/demandelivraisons/client/\" + localStorage.getItem(\"iduser\"))\r\n            .then((response) => {\r\n              this.demandes = response.data;\r\n              this.open = false;\r\n               this.$swal({\r\n          position: \"top-end\",\r\n          icon: \"success\",\r\n          toast: true,\r\n          title: \"Demande Ajouté Avec Succée\",\r\n          showConfirmButton: false,\r\n          timer: 2000,\r\n        })\r\n        location.reload()\r\n            })\r\n\r\n        })\r\n          .catch((error) => console.log(error))\r\n      }\r\n\r\n    },\r\n\r\n    supprimer(id) {\r\n      Swal.fire({\r\n        title: 'Are you sure?',\r\n        text: \"You won't be able to revert this!\",\r\n        icon: 'warning',\r\n        showCancelButton: true,\r\n        confirmButtonColor: '#3085d6',\r\n        cancelButtonColor: '#d33',\r\n        confirmButtonText: 'Yes, delete it!'\r\n      }).then((result) => {\r\n        if (result.isConfirmed) {\r\n          axios.delete('http://localhost:5000/api/demandelivraisons/' + id)\r\n            .then(() => {\r\n              axios\r\n                .get(\"http://localhost:5000/api/demandelivraisons/client/\" + localStorage.getItem(\"iduser\"))\r\n                .then((response) => {\r\n                  this.demandes = response.data\r\n                })\r\n            })\r\n\r\n          const Toast = Swal.mixin({\r\n            toast: true,\r\n            position: 'top-end',\r\n            showConfirmButton: false,\r\n            timer: 3000,\r\n            timerProgressBar: true,\r\n            didOpen: (toast) => {\r\n              toast.addEventListener('mouseenter', Swal.stopTimer)\r\n              toast.addEventListener('mouseleave', Swal.resumeTimer)\r\n            }\r\n          })\r\n\r\n          Toast.fire({\r\n            icon: 'success',\r\n            title: 'Demande supprimé avec succée'\r\n          })\r\n        }\r\n      })\r\n\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style>\r\n.modal {\r\n  transition: opacity 0.25s ease;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}